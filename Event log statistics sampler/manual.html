http://social.technet.microsoft.com/wiki/contents/articles/32204.powershell-event-viewer-statistics.aspx

 

Versioning:

v5 : first release

v5a: fixed $_.LevelDisplayName sorting issue

 

Introduction
The Powerscript below is a modular script that offers following functions:

 display the event log properties
analyse number of events per category
analyse number of events per severity
overview of error events with source, severity and sample message
detailed list of last event per eventID
You can configure the script:

choice of event logs
history length (period of events to report on)
enable/disable logging
enable/disable result export to file
 

Usage
Before you start
download the txt file and remove the txt extension to create the ps1 file
validate your script execution policy
copy the script to a separate folder where you can execute the script
validate the script parameters
Script configuration parameters
$enableLogging
$TRUE = create a transcript of the script during run (does not work in ISE)
$FALSE = do not create a verbose log
$ExportEnabled
$FALSE = do not export the result to file
$TRUE = export the results, statistics and event details to file
$EventLogList
Default: 'System','Application','Setup','Forefront Identity Manager','Forefront Identity Manager Management Agent'
$startdate
Defines from which point in time the event logs must be analysed
HINT: on a system with a large size of event logs, it's advised to limit the history to x days or x weeks. A large volume event log will impact the usage of script memory.
